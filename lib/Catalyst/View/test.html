<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Download.pm</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:travis@zen.local" />
</head>

<body style="background-color: white">


<!-- INDEX BEGIN -->
<div name="index">
<p><a name="__index__"></a></p>

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#version">VERSION</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#config">CONFIG</a></li>
	<li><a href="#content_type_module_requirements">Content-Type Module Requirements</a></li>
	<li><a href="#current_content_types_supported">CURRENT CONTENT-TYPES SUPPORTED</a></li>
	<ul>

		<li><a href="#text_csv">text/csv</a></li>
		<li><a href="#text_plain">text/plain</a></li>
	</ul>

	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#bugs">BUGS</a></li>
	<li><a href="#support">SUPPORT</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#contributors">CONTRIBUTORS</a></li>
	<li><a href="#acknowledgements">ACKNOWLEDGEMENTS</a></li>
	<li><a href="#copyright___license">COPYRIGHT &amp; LICENSE</a></li>
</ul>

<hr name="index" />
</div>
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>Catalyst::View::Download</p>
<p>
</p>
<hr />
<h1><a name="version">VERSION</a></h1>
<p>Version 0.01</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
        # lib/MyApp/View/Download.pm
        package MyApp::View::Download;
        use base qw( Catalyst::View::Download );
        1;</pre>
<pre>
        # lib/MyApp/Controller/SomeController.pm
        sub example_action_1 : Local {
                my ($self, $c) = @_;</pre>
<pre>
                my $content_type = $c-&gt;request-&gt;params-&gt;{'content_type'} || 'plain'; # 'plain' or 'csv'</pre>
<pre>
                $c-&gt;header('Content-Type' =&gt; 'text/'.$content_type); # Set the content type so Catalyst::View::Download can determine how to process it.</pre>
<pre>
                # Array reference of array references.
                my $data = [
                        ['col 1','col 2','col ...','col N'], # row 1
                        ['col 1','col 2','col ...','col N'], # row 2
                        ['col 1','col 2','col ...','col N'], # row ...
                        ['col 1','col 2','col ...','col N']  # row N
                ];</pre>
<pre>
                # If the chosen content_type is 'csv' then the render function of Catalyst::View::Download::CSV will be called which uses the 'csv' stash key
                $c-&gt;stash-&gt;{'csv'} = $data;</pre>
<pre>
                # For plain text in this example we just dump the example array
                # Catalyst::View::Download::Plain will use either the 'plain' stash key or just pull from $c-&gt;response-&gt;body
                use Data::Dumper;
                $c-&gt;response-&gt;body( Dumper( $data ) )</pre>
<pre>
                # Finally forward processing to the Download View
                $c-&gt;forward('MyApp::View::Download');
        }</pre>
<p>
</p>
<hr />
<h1><a name="config">CONFIG</a></h1>
<dl>
<dt><strong><a name="default" class="item">default</a></strong>

<dd>
<p>Determines which Content-Type to use by default. Default: 'text/plain'</p>
</dd>
<dd>
<pre>
        $c-&gt;view('MyApp::View::Download')-&gt;config('default' =&gt; 'text/plain');</pre>
</dd>
</li>
<dt><strong><a name="content_type" class="item">content_type</a></strong>

<dd>
<p>A hash ref of hash refs. Each key in content_type is Content-Type that is handled by this view.</p>
</dd>
<dd>
<pre>
        $c-&gt;view('MyApp::View::Download')-&gt;config-&gt;{'content_type'}{'text/csv'} = {
                'outfile' =&gt; 'somefile.csv',
                'module' =&gt; 'My::Module'
        };</pre>
</dd>
<dd>
<p>The Content-Type key refers to it's own hash of parameters to determine the actions thie view should take for that Content-Type.</p>
</dd>
<dd>
<p>'outfile' - The name and extenstion of the file that will display by default in the download dialog box.</p>
</dd>
<dd>
<p>'module' - The name of the module that will handle data output. If there is a plus symbol '+' at the beginning of the module name, this will indicate that the module is a Catalyst::View module will will add 'Catalyst::View::' to the beginning of the module name.</p>
</dd>
<dd>
<pre>
        $c-&gt;view('MyApp::View::Download')-&gt;config-&gt;{'content_type'}{'text/csv'}{'module'} = '+Download::CSV'; # Module Loaded: Catalyst::View::Download::CSV</pre>
</dd>
<dd>
<pre>
        $c-&gt;view('MyApp::View::Download')-&gt;config-&gt;{'content_type'}{'text/csv'}{'module'} = 'My::Module::CSV'; # Module Loaded: My::Module::CSV</pre>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="content_type_module_requirements">Content-Type Module Requirements</a></h1>
<p>Any module set as 'the' module for a certain Content-Type needs to have a subroutine named 'render' that returns the content to output with the following parameters handled.</p>
<dl>
<dt><strong><a name="_c" class="item">$c</a></strong>

<dd>
<p>The catalyst $c variable</p>
</dd>
</li>
<dt><strong><a name="_template" class="item">$template</a></strong>

<dd>
<p>In case a template file is needed for the module. This view will pass $c-&gt;stash-&gt;{template} as this value.</p>
</dd>
</li>
<dt><strong><a name="_args" class="item">$args</a></strong>

<dd>
<p>A list of arguments the module will use to process the data into content. This view will pass $c-&gt;stash as this value.</p>
</dd>
</li>
</dl>
<p>
</p>
<hr />
<h1><a name="current_content_types_supported">CURRENT CONTENT-TYPES SUPPORTED</a></h1>
<p>
</p>
<h2><a name="text_csv">text/csv</a></h2>
<p>Catalyst::View::Download has the following default configuration for this Content-Type</p>
<pre>
        $c-&gt;view('MyApp::View::Download')-&gt;config-&gt;{'content_type'}{'text/csv'} = {
                'outfile' =&gt; 'data.csv',
                'module' =&gt; '+Download::CSV'
        };</pre>
<p>See <a href="/Catalyst/View/Download/CSV.html">the Catalyst::View::Download::CSV manpage</a> for more details.</p>
<p>
</p>
<h2><a name="text_plain">text/plain</a></h2>
<p>Catalyst::View::Download has the following default configuration for this Content-Type</p>
<pre>
        $c-&gt;view('MyApp::View::Download')-&gt;config-&gt;{'default'} = 'text/plain';</pre>
<pre>
        $c-&gt;view('MyApp::View::Download')-&gt;config-&gt;{'content_type'}{'text/csv'} = {
                'outfile' =&gt; 'data.csv',
                'module' =&gt; '+Download::CSV'
        };
        
See L&lt;Catalyst::View::Download::Plain&gt; for more details.</pre>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Travis Chase, <code>&lt;gaudeon at cpan.org&gt;</code></p>
<p>
</p>
<hr />
<h1><a name="bugs">BUGS</a></h1>
<p>Please report any bugs or feature requests to <code>bug-catalyst-view-download at rt.cpan.org</code>, or through
the web interface at <a href="http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Catalyst-View-Download">http://rt.cpan.org/NoAuth/ReportBug.html</a>.  I will be notified, and then you'll
automatically be notified of progress on your bug as I make changes.</p>
<p>
</p>
<hr />
<h1><a name="support">SUPPORT</a></h1>
<p>You can find documentation for this module with the perldoc command.</p>
<pre>
    perldoc Catalyst::View::Download</pre>
<p>You can also look for information at:</p>
<ul>
<li><strong><a name="rt_cpan_s_request_tracker" class="item">RT: CPAN's request tracker</a></strong>

<p><a href="http://rt.cpan.org/NoAuth/Bugs.html?Dist=Catalyst-View-Download">http://rt.cpan.org/NoAuth/Bugs.html</a></p>
</li>
<li><strong><a name="annocpan_annotated_cpan_documentation" class="item">AnnoCPAN: Annotated CPAN documentation</a></strong>

<p><a href="http://annocpan.org/dist/Catalyst-View-Download">http://annocpan.org/dist/Catalyst-View-Download</a></p>
</li>
<li><strong><a name="cpan_ratings" class="item">CPAN Ratings</a></strong>

<p><a href="http://cpanratings.perl.org/d/Catalyst-View-Download">http://cpanratings.perl.org/d/Catalyst-View-Download</a></p>
</li>
<li><strong><a name="search_cpan" class="item">Search CPAN</a></strong>

<p><a href="http://search.cpan.org/dist/Catalyst-View-Download">http://search.cpan.org/dist/Catalyst-View-Download</a></p>
</li>
</ul>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><em>Catalyst</em> <a href="/Catalyst/View.html">the Catalyst::View manpage</a></p>
<p>
</p>
<hr />
<h1><a name="contributors">CONTRIBUTORS</a></h1>
<p>
</p>
<hr />
<h1><a name="acknowledgements">ACKNOWLEDGEMENTS</a></h1>
<p>Thanks to following people for their constructive comments and help:</p>
<dl>
<dt><strong><a name="j_shirley" class="item">J. Shirley</a></strong>

<dt><strong><a name="jonathan_rockway" class="item">Jonathan Rockway</a></strong>

</dl>
<p>Thanks also to my company Ti4 Technologies for their financial support. <a href="http://www.ti4tech.com/">http://www.ti4tech.com/</a></p>
<p>
</p>
<hr />
<h1><a name="copyright___license">COPYRIGHT &amp; LICENSE</a></h1>
<p>Copyright 2008 Travis Chase, all rights reserved.</p>
<p>This program is free software; you can redistribute it and/or modify it
under the same terms as Perl itself.</p>

</body>

</html>
